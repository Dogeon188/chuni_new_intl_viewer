(function(){"use strict";function Ae(e){const t=document.cookie.split(";").map(n=>decodeURIComponent(n.trim())).map(n=>n.split("=")).find(n=>n[0]===e);return t?t[1]:""}function Me(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}function at(e){return Number([...e].filter(t=>t!==",").join(""))}function Q(){}function Fe(e){return e()}function Oe(){return Object.create(null)}function te(e){e.forEach(Fe)}function ft(e){return typeof e=="function"}function fe(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let he;function je(e,t){return he||(he=document.createElement("a")),he.href=t,e===he.href}function ht(e){return Object.keys(e).length===0}function Ie(e){return e==null?"":e}function h(e,t){e.appendChild(t)}function de(e,t,n){const r=dt(e);if(!r.getElementById(t)){const i=p("style");i.id=t,i.textContent=n,mt(r,i)}}function dt(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function mt(e,t){h(e.head||e,t)}function F(e,t,n){e.insertBefore(t,n||null)}function L(e){e.parentNode.removeChild(e)}function De(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function p(e){return document.createElement(e)}function E(e){return document.createTextNode(e)}function x(){return E(" ")}function oe(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function b(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function gt(e){return Array.from(e.childNodes)}function j(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}let $e;function ce(e){$e=e}const le=[],Be=[],me=[],Ue=[],bt=Promise.resolve();let ke=!1;function pt(){ke||(ke=!0,bt.then(He))}function Ee(e){me.push(e)}const Te=new Set;let ge=0;function He(){const e=$e;do{for(;ge<le.length;){const t=le[ge];ge++,ce(t),vt(t.$$)}for(ce(null),le.length=0,ge=0;Be.length;)Be.pop()();for(let t=0;t<me.length;t+=1){const n=me[t];Te.has(n)||(Te.add(n),n())}me.length=0}while(le.length);for(;Ue.length;)Ue.pop()();ke=!1,Te.clear(),ce(e)}function vt(e){if(e.fragment!==null){e.update(),te(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ee)}}const be=new Set;let Y;function wt(){Y={r:0,c:[],p:Y}}function _t(){Y.r||te(Y.c),Y=Y.p}function I(e,t){e&&e.i&&(be.delete(e),e.i(t))}function H(e,t,n,r){if(e&&e.o){if(be.has(e))return;be.add(e),Y.c.push(()=>{be.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}function ne(e){e&&e.c()}function Z(e,t,n,r){const{fragment:i,on_mount:o,on_destroy:c,after_update:u}=e.$$;i&&i.m(t,n),r||Ee(()=>{const s=o.map(Fe).filter(ft);c?c.push(...s):te(s),e.$$.on_mount=[]}),u.forEach(Ee)}function N(e,t){const n=e.$$;n.fragment!==null&&(te(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function yt(e,t){e.$$.dirty[0]===-1&&(le.push(e),pt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function pe(e,t,n,r,i,o,c,u=[-1]){const s=$e;ce(e);const a=e.$$={fragment:null,ctx:null,props:o,update:Q,not_equal:i,bound:Oe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(s?s.$$.context:[])),callbacks:Oe(),dirty:u,skip_bound:!1,root:t.target||s.$$.root};c&&c(a.root);let l=!1;if(a.ctx=n?n(e,t.props||{},(f,w,...T)=>{const k=T.length?T[0]:w;return a.ctx&&i(a.ctx[f],a.ctx[f]=k)&&(!a.skip_bound&&a.bound[f]&&a.bound[f](k),l&&yt(e,f)),w}):[],a.update(),l=!0,te(a.before_update),a.fragment=r?r(a.ctx):!1,t.target){if(t.hydrate){const f=gt(t.target);a.fragment&&a.fragment.l(f),f.forEach(L)}else a.fragment&&a.fragment.c();t.intro&&I(e.$$.fragment),Z(e,t.target,t.anchor,t.customElement),He()}ce(s)}class ve{$destroy(){N(this,1),this.$destroy=Q}$on(t,n){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(t){this.$$set&&!ht(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function xt(e,t){t*=100;const n=[[101e4,t+215],[1009e3,t+215],[1007500,t+200],[1005e3,t+150],[1e6,t+100],[975e3,t],[925e3,t-300],[9e5,t-500],[8e5,(t-500)/2],[5e5,0]];let r=1;n.some((u,s)=>(r=s,e>u[0]));const i=n[r-1],o=n[r],c=o[1]+(i[1]-o[1])/(i[0]-o[0])*(e-o[0]);return Math.floor(c+Number.EPSILON)/100}function Ve(e){return e.slice(0,30).reduce((t,n)=>t+n)/30}function St(e){return(Ve(e)*30+e[0]*10)/40}const V={ultima:"ULT",master:"MAS",expert:"EXP",advance:"ADV",basic:"BAS"};async function $t(e=V.master){const t=new FormData;t.append("genre","99"),t.append("token",Ae("_t"));const n={[V.ultima]:"sendUltima",[V.master]:"sendMaster",[V.expert]:"sendExpert",[V.advance]:"sendAdvance",[V.basic]:"sendBasic"},i=await(await fetch(`https://chunithm-net-eng.com/mobile/record/musicGenre/${n[e]}`,{headers:{"Cache-Control":"no-cache"},method:"POST",body:t})).text(),o=[...$(i).find("form")];return o.shift(),o}async function kt(){const e=[];for(const t of Object.values(V))e.push(await $t(t));return e.flatMap((t,n)=>t.map(r=>{var u,s;const i=$(r),o=i.find(".play_musicdata_icon");let c=null;if(o.length){for(const a of["fullchain","fullchain2","alljustice","fullcombo"])if(o.find(`img[src*="${a}"]`).length){c=a;break}}return{title:(u=i.find(".music_title"))==null?void 0:u.text(),score:at((s=i.find(".text_b"))==null?void 0:s.text()),difficulty:Object.values(V)[n],clear:c}}).filter(r=>r.title!==null&&r.score>0))}async function Et(){const e=await(await fetch("https://raw.githubusercontent.com/Dogeon188/chuni_new_intl_viewer/main/songData.json")).json(),t=await kt();return t.map(n=>{const r=e[n.title];if(r===void 0){alert(`[chuni-intl-viewer] Found unknown song "${n.title} ${n.difficulty}".
The data should be updating soon, please run chuni-viewer again later to get proper song data.`),fetch(new Request("https://chuniupdate.dogeon188.repl.co/sendUpdate",{method:"POST"})),n.const=0,n.rating=0;return}n.const=r[n.difficulty],n.rating=xt(n.score,n.const)}),t.sort((n,r)=>r.rating-n.rating||r.const-n.const),t.map((n,r)=>{n.rank=r+1}),t}function Tt(e){de(e,"svelte-dndlcq","dt.svelte-dndlcq{color:#c9e;font-size:small}dd.svelte-dndlcq{margin-inline-start:0}")}function qt(e){let t,n,r,i,o,c;return{c(){t=p("div"),n=p("dt"),r=E(e[0]),i=x(),o=p("dd"),c=E(e[1]),b(n,"class","svelte-dndlcq"),b(o,"class","svelte-dndlcq")},m(u,s){F(u,t,s),h(t,n),h(n,r),h(t,i),h(t,o),h(o,c)},p(u,[s]){s&1&&j(r,u[0]),s&2&&j(c,u[1])},i:Q,o:Q,d(u){u&&L(t)}}}function Rt(e,t,n){let{title:r}=t,{content:i}=t;return e.$$set=o=>{"title"in o&&n(0,r=o.title),"content"in o&&n(1,i=o.content)},[r,i]}class we extends ve{constructor(t){super(),pe(this,t,Rt,qt,fe,{title:0,content:1},Tt)}}function Pt(e){de(e,"svelte-11jwvwy","div.svelte-11jwvwy{border:#536 3px solid;border-radius:0.5rem;background-color:#324;width:fit-content;padding:0.5rem;margin:0.5rem;text-align:center;display:flex;justify-content:space-around;width:calc(100% - 2rem - 6px)}")}function Ct(e){let t,n,r,i,o,c,u,s,a;return n=new we({props:{title:"Generated at",content:new Date().toLocaleDateString()}}),i=new we({props:{title:"Best 30 Avg.",content:e[0].toFixed(2)}}),c=new we({props:{title:"Max Achievable",content:e[1].toFixed(2)}}),s=new we({props:{title:"Total MAS Score",content:e[2].toString()}}),{c(){t=p("div"),ne(n.$$.fragment),r=x(),ne(i.$$.fragment),o=x(),ne(c.$$.fragment),u=x(),ne(s.$$.fragment),b(t,"class","svelte-11jwvwy")},m(l,f){F(l,t,f),Z(n,t,null),h(t,r),Z(i,t,null),h(t,o),Z(c,t,null),h(t,u),Z(s,t,null),a=!0},p(l,[f]){const w={};f&1&&(w.content=l[0].toFixed(2)),i.$set(w);const T={};f&2&&(T.content=l[1].toFixed(2)),c.$set(T);const k={};f&4&&(k.content=l[2].toString()),s.$set(k)},i(l){a||(I(n.$$.fragment,l),I(i.$$.fragment,l),I(c.$$.fragment,l),I(s.$$.fragment,l),a=!0)},o(l){H(n.$$.fragment,l),H(i.$$.fragment,l),H(c.$$.fragment,l),H(s.$$.fragment,l),a=!1},d(l){l&&L(t),N(n),N(i),N(c),N(s)}}}function Lt(e,t,n){let{b30:r}=t,{maxAchievable:i}=t,{totalMasterScore:o}=t;return e.$$set=c=>{"b30"in c&&n(0,r=c.b30),"maxAchievable"in c&&n(1,i=c.maxAchievable),"totalMasterScore"in c&&n(2,o=c.totalMasterScore)},[r,i,o]}class At extends ve{constructor(t){super(),pe(this,t,Lt,Ct,fe,{b30:0,maxAchievable:1,totalMasterScore:2},Pt)}}var We=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function u(l){try{a(r.next(l))}catch(f){c(f)}}function s(l){try{a(r.throw(l))}catch(f){c(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,s)}a((r=r.apply(e,t||[])).next())})};const Ge="application/font-woff",ze="image/jpeg",Mt={woff:Ge,woff2:Ge,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:ze,jpeg:ze,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"};function Ft(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function _e(e){const t=Ft(e).toLowerCase();return Mt[t]||""}function Ot(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),t&&(r.href=t),i.href=e,i.href}function qe(e){return e.search(/^(data:)/)!==-1}function ye(e,t){return`data:${t};base64,${e}`}function jt(e){return e.split(/,/)[1]}const It=function(){let t=0;const n=()=>`0000${(Math.random()*Math.pow(36,4)<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${n()}${t}`)}();function W(e){const t=[];for(let n=0,r=e.length;n<r;n+=1)t.push(e[n]);return t}function xe(e,t){const n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}function Dt(e){const t=xe(e,"border-left-width"),n=xe(e,"border-right-width");return e.clientWidth+t+n}function Bt(e){const t=xe(e,"border-top-width"),n=xe(e,"border-bottom-width");return e.clientHeight+t+n}function Ut(){let e,t;try{t=process}catch{}const n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}function Ht(e){return e.toBlob?new Promise(t=>e.toBlob(t)):new Promise(t=>{const n=window.atob(e.toDataURL().split(",")[1]),r=n.length,i=new Uint8Array(r);for(let o=0;o<r;o+=1)i[o]=n.charCodeAt(o);t(new Blob([i],{type:"image/png"}))})}function Re(e){return new Promise((t,n)=>{const r=new Image;r.onload=()=>t(r),r.onerror=n,r.crossOrigin="anonymous",r.decoding="sync",r.src=e})}function Vt(e){return We(this,void 0,void 0,function*(){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)})}function Wt(e,t,n){return We(this,void 0,void 0,function*(){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),o=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${t}`),i.setAttribute("height",`${n}`),i.setAttribute("viewBox",`0 0 ${t} ${n}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),i.appendChild(o),o.appendChild(e),Vt(i)})}const Pe={};function Gt(e){let t=e.replace(/\?.*/,"");return/ttf|otf|eot|woff2?/i.test(t)&&(t=t.replace(/.*\//,"")),t}function Ce(e,t){const n=Gt(e);if(Pe[n]!=null)return Pe[n];t.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());const r=o=>{let c="";if(t.imagePlaceholder){const s=t.imagePlaceholder.split(/,/);s&&s[1]&&(c=s[1])}let u=`Failed to fetch resource: ${e}`;return o&&(u=typeof o=="string"?o:o.message),u&&console.error(u),{blob:c,contentType:""}},i=window.fetch(e).then(o=>o.blob().then(c=>({blob:c,contentType:o.headers.get("Content-Type")||""}))).then(({blob:o,contentType:c})=>new Promise((u,s)=>{const a=new FileReader;a.onloadend=()=>u({contentType:c,blob:a.result}),a.onerror=s,a.readAsDataURL(o)})).then(({blob:o,contentType:c})=>({contentType:c,blob:jt(o)})).catch(r);return Pe[n]=i,i}function zt(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function Xt(e){return W(e).map(t=>{const n=e.getPropertyValue(t),r=e.getPropertyPriority(t);return`${t}: ${n}${r?" !important":""};`}).join(" ")}function Jt(e,t,n){const r=`.${e}:${t}`,i=n.cssText?zt(n):Xt(n);return document.createTextNode(`${r}{${i}}`)}function Xe(e,t,n){const r=window.getComputedStyle(e,n),i=r.getPropertyValue("content");if(i===""||i==="none")return;const o=It();try{t.className=`${t.className} ${o}`}catch{return}const c=document.createElement("style");c.appendChild(Jt(o,n,r)),t.appendChild(c)}function Kt(e,t){Xe(e,t,":before"),Xe(e,t,":after")}var re=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function u(l){try{a(r.next(l))}catch(f){c(f)}}function s(l){try{a(r.throw(l))}catch(f){c(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,s)}a((r=r.apply(e,t||[])).next())})};function Qt(e){return re(this,void 0,void 0,function*(){const t=e.toDataURL();return t==="data:,"?Promise.resolve(e.cloneNode(!1)):Re(t)})}function Yt(e,t){return re(this,void 0,void 0,function*(){return Promise.resolve(e.poster).then(n=>Ce(n,t)).then(n=>ye(n.blob,_e(e.poster)||n.contentType)).then(n=>Re(n))})}function Zt(e,t){return re(this,void 0,void 0,function*(){return e instanceof HTMLCanvasElement?Qt(e):e instanceof HTMLVideoElement&&e.poster?Yt(e,t):Promise.resolve(e.cloneNode(!1))})}const Nt=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT";function en(e,t,n){var r;return re(this,void 0,void 0,function*(){const i=Nt(e)&&e.assignedNodes?W(e.assignedNodes()):W(((r=e.shadowRoot)!==null&&r!==void 0?r:e).childNodes);return i.length===0||e instanceof HTMLVideoElement?Promise.resolve(t):i.reduce((o,c)=>o.then(()=>Je(c,n)).then(u=>{u&&t.appendChild(u)}),Promise.resolve()).then(()=>t)})}function tn(e,t){const n=window.getComputedStyle(e),r=t.style;!r||(n.cssText?r.cssText=n.cssText:W(n).forEach(i=>{r.setProperty(i,n.getPropertyValue(i),n.getPropertyPriority(i))}))}function nn(e,t){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}function rn(e,t){return re(this,void 0,void 0,function*(){return t instanceof Element?Promise.resolve().then(()=>tn(e,t)).then(()=>Kt(e,t)).then(()=>nn(e,t)).then(()=>t):Promise.resolve(t)})}function Je(e,t,n){return re(this,void 0,void 0,function*(){return!n&&t.filter&&!t.filter(e)?Promise.resolve(null):Promise.resolve(e).then(r=>Zt(r,t)).then(r=>en(e,r,t)).then(r=>rn(e,r))})}var on=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function u(l){try{a(r.next(l))}catch(f){c(f)}}function s(l){try{a(r.throw(l))}catch(f){c(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,s)}a((r=r.apply(e,t||[])).next())})};const Ke=/url\((['"]?)([^'"]+?)\1\)/g,cn=/url\([^)]+\)\s*format\((["'])([^"']+)\1\)/g,ln=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function sn(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function un(e){const t=[];return e.replace(Ke,(n,r,i)=>(t.push(i),n)),t.filter(n=>!qe(n))}function an(e,t,n,r,i){const o=n?Ot(t,n):t;return Promise.resolve(o).then(c=>i?i(c):Ce(c,r)).then(c=>typeof c=="string"?ye(c,_e(t)):ye(c.blob,_e(t)||c.contentType)).then(c=>e.replace(sn(t),`$1${c}$3`)).then(c=>c,()=>o)}function fn(e,{preferredFontFormat:t}){return t?e.replace(ln,n=>{for(;;){const[r,,i]=cn.exec(n)||[];if(!i)return"";if(i===t)return`src: ${r};`}}):e}function Qe(e){return e.search(Ke)!==-1}function Ye(e,t,n){return on(this,void 0,void 0,function*(){if(!Qe(e))return Promise.resolve(e);const r=fn(e,n);return Promise.resolve(r).then(un).then(i=>i.reduce((o,c)=>o.then(u=>an(u,c,t,n)),Promise.resolve(r)))})}var Se=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function u(l){try{a(r.next(l))}catch(f){c(f)}}function s(l){try{a(r.throw(l))}catch(f){c(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,s)}a((r=r.apply(e,t||[])).next())})};function hn(e,t){var n;return Se(this,void 0,void 0,function*(){const r=(n=e.style)===null||n===void 0?void 0:n.getPropertyValue("background");return r?Promise.resolve(r).then(i=>Ye(i,null,t)).then(i=>(e.style.setProperty("background",i,e.style.getPropertyPriority("background")),e)):Promise.resolve(e)})}function dn(e,t){return Se(this,void 0,void 0,function*(){if(!(e instanceof HTMLImageElement&&!qe(e.src))&&!(e instanceof SVGImageElement&&!qe(e.href.baseVal)))return Promise.resolve(e);const n=e instanceof HTMLImageElement?e.src:e.href.baseVal;return Promise.resolve(n).then(r=>Ce(r,t)).then(r=>ye(r.blob,_e(n)||r.contentType)).then(r=>new Promise((i,o)=>{e.onload=i,e.onerror=o,e instanceof HTMLImageElement?(e.srcset="",e.src=r):e.href.baseVal=r})).then(()=>e,()=>e)})}function mn(e,t){return Se(this,void 0,void 0,function*(){const r=W(e.childNodes).map(i=>Ze(i,t));return Promise.all(r).then(()=>e)})}function Ze(e,t){return Se(this,void 0,void 0,function*(){return e instanceof Element?Promise.resolve(e).then(n=>hn(n,t)).then(n=>dn(n,t)).then(n=>mn(n,t)):Promise.resolve(e)})}function gn(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const r=t.style;return r!=null&&Object.keys(r).forEach(i=>{n[i]=r[i]}),e}var se=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function u(l){try{a(r.next(l))}catch(f){c(f)}}function s(l){try{a(r.throw(l))}catch(f){c(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,s)}a((r=r.apply(e,t||[])).next())})};const Ne={};function et(e){const t=Ne[e];if(t!=null)return t;const n=window.fetch(e).then(r=>({url:e,cssText:r.text()}));return Ne[e]=n,n}function tt(e){return se(this,void 0,void 0,function*(){return e.cssText.then(t=>{let n=t;const r=/url\(["']?([^"')]+)["']?\)/g,o=(n.match(/url\([^)]+\)/g)||[]).map(c=>{let u=c.replace(r,"$1");return u.startsWith("https://")||(u=new URL(u,e.url).href),window.fetch(u).then(s=>s.blob()).then(s=>new Promise((a,l)=>{const f=new FileReader;f.onloadend=()=>{n=n.replace(c,`url(${f.result})`),a([c,f.result])},f.onerror=l,f.readAsDataURL(s)}))});return Promise.all(o).then(()=>n)})})}function nt(e){if(e==null)return[];const t=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(n,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const s=i.exec(r);if(s===null)break;t.push(s[0])}r=r.replace(i,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,c="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(c,"gi");for(;;){let s=o.exec(r);if(s===null){if(s=u.exec(r),s===null)break;o.lastIndex=u.lastIndex}else u.lastIndex=o.lastIndex;t.push(s[0])}return t}function bn(e){return se(this,void 0,void 0,function*(){const t=[],n=[];return e.forEach(r=>{if("cssRules"in r)try{W(r.cssRules).forEach((i,o)=>{if(i.type===CSSRule.IMPORT_RULE){let c=o+1;const u=i.href,s=et(u).then(a=>a?tt(a):"").then(a=>nt(a).forEach(l=>{try{r.insertRule(l,l.startsWith("@import")?c+=1:r.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:l,error:f})}})).catch(a=>{console.error("Error loading remote css",a.toString())});n.push(s)}})}catch(i){const o=e.find(c=>c.href==null)||document.styleSheets[0];r.href!=null&&n.push(et(r.href).then(c=>c?tt(c):"").then(c=>nt(c).forEach(u=>{o.insertRule(u,r.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c.toString())})),console.error("Error inlining remote css file",i.toString())}}),Promise.all(n).then(()=>(e.forEach(r=>{if("cssRules"in r)try{W(r.cssRules).forEach(i=>{t.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${r.href}`,i.toString())}}),t))})}function pn(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>Qe(t.style.getPropertyValue("src")))}function vn(e){return se(this,void 0,void 0,function*(){return new Promise((t,n)=>{e.ownerDocument==null&&n(new Error("Provided element is not within a Document")),t(W(e.ownerDocument.styleSheets))}).then(t=>bn(t)).then(pn)})}function wn(e,t){return se(this,void 0,void 0,function*(){return vn(e).then(n=>Promise.all(n.map(r=>{const i=r.parentStyleSheet?r.parentStyleSheet.href:null;return Ye(r.cssText,i,t)}))).then(n=>n.join(`
`))})}function _n(e,t){return se(this,void 0,void 0,function*(){return(t.fontEmbedCSS!=null?Promise.resolve(t.fontEmbedCSS):wn(e,t)).then(n=>{const r=document.createElement("style"),i=document.createTextNode(n);return r.appendChild(i),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r),e})})}var Le=globalThis&&globalThis.__awaiter||function(e,t,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function u(l){try{a(r.next(l))}catch(f){c(f)}}function s(l){try{a(r.throw(l))}catch(f){c(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,s)}a((r=r.apply(e,t||[])).next())})};function rt(e,t={}){const n=t.width||Dt(e),r=t.height||Bt(e);return{width:n,height:r}}function yn(e,t={}){return Le(this,void 0,void 0,function*(){const{width:n,height:r}=rt(e,t);return Promise.resolve(e).then(i=>Je(i,t,!0)).then(i=>_n(i,t)).then(i=>Ze(i,t)).then(i=>gn(i,t)).then(i=>Wt(i,n,r))})}const R=16384;function xn(e){(e.width>R||e.height>R)&&(e.width>R&&e.height>R?e.width>e.height?(e.height*=R/e.width,e.width=R):(e.width*=R/e.height,e.height=R):e.width>R?(e.height*=R/e.width,e.width=R):(e.width*=R/e.height,e.height=R))}function Sn(e,t={}){return Le(this,void 0,void 0,function*(){return yn(e,t).then(Re).then(n=>{const r=document.createElement("canvas"),i=r.getContext("2d"),o=t.pixelRatio||Ut(),{width:c,height:u}=rt(e,t),s=t.canvasWidth||c,a=t.canvasHeight||u;return r.width=s*o,r.height=a*o,t.skipAutoScale||xn(r),r.style.width=`${s}`,r.style.height=`${a}`,t.backgroundColor&&(i.fillStyle=t.backgroundColor,i.fillRect(0,0,r.width,r.height)),i.drawImage(n,0,0,r.width,r.height),r})})}function $n(e,t={}){return Le(this,void 0,void 0,function*(){return Sn(e,t).then(Ht)})}async function it(e){var r,i;const t=(r=document.body.shadowRoot)==null?void 0:r.querySelector("main");let n=t==null?void 0:t.cloneNode(!0);(i=t==null?void 0:t.parentElement)==null||i.appendChild(n),n.querySelectorAll("tr").forEach((o,c)=>{c>(e=="b30"?30:40)&&o.remove()}),$n(n,{backgroundColor:"#223"}).then(async o=>{if(n.remove(),o==null)return alert("[chuni-intl-viewer] Something went wrong when converting your scores to PNG. Please ask the author to fix it.");if(Me()){const c=new File([o],`result_${e}.png`,{type:o.type});navigator!=null&&navigator.canShare({files:[c]})&&navigator.share({files:[c],text:"#CHUNITHM"}).catch(console.log)}else $("<a>").attr({download:`result_${e}.png`,href:window.URL.createObjectURL(o)})[0].click()})}function kn(e){de(e,"svelte-qxb8c1",'@charset "UTF-8";button.svelte-qxb8c1.svelte-qxb8c1{margin:0.5rem;padding:0.3rem;font-family:inherit;font-weight:bold;background-color:#324;border:#536 3px solid;color:#eec;border-radius:0.3rem;cursor:pointer}button.svelte-qxb8c1.svelte-qxb8c1:disabled{cursor:default;opacity:0.5}button.filter.svelte-qxb8c1.svelte-qxb8c1{border-color:#48c;background-color:#159;width:6rem}button.sort.svelte-qxb8c1.svelte-qxb8c1{border-color:#48c;background-color:#159}button.dl.svelte-qxb8c1 i.svelte-qxb8c1{background-image:url(https://raw.githubusercontent.com/Dogeon188/chuni_new_intl_viewer/main/assets/dl.png);display:inline-block;width:1rem;height:1rem;background-position:0px 0px;background-size:cover}table.svelte-qxb8c1.svelte-qxb8c1{border-spacing:0;width:100%;padding-bottom:0.5rem}td.svelte-qxb8c1.svelte-qxb8c1,th.svelte-qxb8c1.svelte-qxb8c1{padding:0.5rem}th.current-sort.svelte-qxb8c1.svelte-qxb8c1:before{content:"\u25BC"}tbody.svelte-qxb8c1 tr.best30 td.svelte-qxb8c1:first-child{color:#fc4}tbody.svelte-qxb8c1 tr.best40 td.svelte-qxb8c1:first-child{font-weight:bold}tbody.svelte-qxb8c1 tr.svelte-qxb8c1:nth-child(odd){background-color:#324}tbody.svelte-qxb8c1 tr td.svelte-qxb8c1:nth-child(2){overflow:hidden;text-overflow:ellipsis;font-weight:bold}tbody.svelte-qxb8c1 tr td:nth-child(2).diff-ult.svelte-qxb8c1{color:#3cf}tbody.svelte-qxb8c1 tr td:nth-child(2).diff-mas.svelte-qxb8c1{color:#e9f}tbody.svelte-qxb8c1 tr td:nth-child(2).diff-exp.svelte-qxb8c1{color:#e46}tbody.svelte-qxb8c1 tr td:nth-child(2).diff-adv.svelte-qxb8c1{color:#e73}tbody.svelte-qxb8c1 tr td:nth-child(2).diff-bas.svelte-qxb8c1{color:#1c3}')}function ot(e,t,n){const r=e.slice();return r[13]=t[n],r}function ct(e,t,n){const r=e.slice();return r[16]=t[n],r}function lt(e){let t,n,r,i,o;function c(){return e[12](e[16])}return{c(){t=p("th"),n=E(e[16]),b(t,"class",r=Ie(e[16]==Object.keys(e[3])[e[1]]?"current-sort":"")+" svelte-qxb8c1")},m(u,s){F(u,t,s),h(t,n),i||(o=oe(t,"click",c),i=!0)},p(u,s){e=u,s&2&&r!==(r=Ie(e[16]==Object.keys(e[3])[e[1]]?"current-sort":"")+" svelte-qxb8c1")&&b(t,"class",r)},d(u){u&&L(t),i=!1,o()}}}function st(e){let t,n,r;return{c(){t=p("img"),je(t.src,n="https://chunithm-net-eng.com/mobile/images/icon_"+e[13].clear+".png")||b(t,"src",n),b(t,"alt",r=e[13].clear)},m(i,o){F(i,t,o)},p(i,o){o&4&&!je(t.src,n="https://chunithm-net-eng.com/mobile/images/icon_"+i[13].clear+".png")&&b(t,"src",n),o&4&&r!==(r=i[13].clear)&&b(t,"alt",r)},d(i){i&&L(t)}}}function ut(e){var ue,K,M,ie;let t,n,r=e[13].rank+"",i,o,c,u=e[13].title+"",s,a,l,f,w=((K=(ue=e[13].const)==null?void 0:ue.toFixed(1))!=null?K:"??.?")+"",T,k,D,m=e[13].score+"",v,ee,G,z=((ie=(M=e[13].rating)==null?void 0:M.toFixed(2))!=null?ie:"??.??")+"",A,B,X,O,J,_=e[13].clear!==null&&st(e);return{c(){t=p("tr"),n=p("td"),i=E(r),o=x(),c=p("td"),s=E(u),l=x(),f=p("td"),T=E(w),k=x(),D=p("td"),v=E(m),ee=x(),G=p("td"),A=E(z),B=x(),X=p("td"),_&&_.c(),O=x(),b(n,"class","svelte-qxb8c1"),b(c,"class",a="diff-"+e[13].difficulty.toLowerCase()+" svelte-qxb8c1"),b(f,"class","svelte-qxb8c1"),b(D,"class","svelte-qxb8c1"),b(G,"class","svelte-qxb8c1"),b(X,"class","svelte-qxb8c1"),b(t,"class",J=(e[13].rank<=30?"best30":"")+" "+(e[13].rank<=40?"best40":"")+" svelte-qxb8c1")},m(y,q){F(y,t,q),h(t,n),h(n,i),h(t,o),h(t,c),h(c,s),h(t,l),h(t,f),h(f,T),h(t,k),h(t,D),h(D,v),h(t,ee),h(t,G),h(G,A),h(t,B),h(t,X),_&&_.m(X,null),h(t,O)},p(y,q){var P,U,S,d;q&4&&r!==(r=y[13].rank+"")&&j(i,r),q&4&&u!==(u=y[13].title+"")&&j(s,u),q&4&&a!==(a="diff-"+y[13].difficulty.toLowerCase()+" svelte-qxb8c1")&&b(c,"class",a),q&4&&w!==(w=((U=(P=y[13].const)==null?void 0:P.toFixed(1))!=null?U:"??.?")+"")&&j(T,w),q&4&&m!==(m=y[13].score+"")&&j(v,m),q&4&&z!==(z=((d=(S=y[13].rating)==null?void 0:S.toFixed(2))!=null?d:"??.??")+"")&&j(A,z),y[13].clear!==null?_?_.p(y,q):(_=st(y),_.c(),_.m(X,null)):_&&(_.d(1),_=null),q&4&&J!==(J=(y[13].rank<=30?"best30":"")+" "+(y[13].rank<=40?"best40":"")+" svelte-qxb8c1")&&b(t,"class",J)},d(y){y&&L(t),_&&_.d()}}}function En(e){let t,n,r=e[0]?"Show All":"Show B40",i,o,c,u,s,a,l,f,w,T,k,D,m,v,ee=Object.keys(e[3])[e[1]]+"",G,z,A,B,X,O,J,_,ue,K,M,ie,y;B=new At({props:{b30:Ve(e[4]),maxAchievable:St(e[4]),totalMasterScore:e[5]}});let q=["#","Title","Const.","Score","Rating","FC/AJ"],P=[];for(let d=0;d<6;d+=1)P[d]=lt(ct(e,q,d));let U=e[2],S=[];for(let d=0;d<U.length;d+=1)S[d]=ut(ot(e,U,d));return{c(){t=p("div"),n=p("button"),i=E(r),o=x(),c=p("button"),u=p("i"),s=E("Best 30"),l=x(),f=p("button"),w=p("i"),T=E("Best 40"),D=x(),m=p("button"),v=E("Sort: "),G=E(ee),z=x(),A=p("main"),ne(B.$$.fragment),X=x(),O=p("table"),J=p("thead"),_=p("tr");for(let d=0;d<6;d+=1)P[d].c();ue=x(),K=p("tbody");for(let d=0;d<S.length;d+=1)S[d].c();b(n,"class","filter svelte-qxb8c1"),b(u,"class","svelte-qxb8c1"),b(c,"class","dl svelte-qxb8c1"),c.disabled=a=e[1]!=0,b(w,"class","svelte-qxb8c1"),b(f,"class","dl svelte-qxb8c1"),f.disabled=k=e[1]!=0,b(m,"class","sort svelte-qxb8c1"),b(t,"class","buttons"),b(K,"class","svelte-qxb8c1"),b(O,"id","chuni-result-table"),b(O,"class","svelte-qxb8c1"),b(A,"id","chuni-viewer-main")},m(d,C){F(d,t,C),h(t,n),h(n,i),h(t,o),h(t,c),h(c,u),h(c,s),h(t,l),h(t,f),h(f,w),h(f,T),h(t,D),h(t,m),h(m,v),h(m,G),F(d,z,C),F(d,A,C),Z(B,A,null),h(A,X),h(A,O),h(O,J),h(J,_);for(let g=0;g<6;g+=1)P[g].m(_,null);h(O,ue),h(O,K);for(let g=0;g<S.length;g+=1)S[g].m(K,null);M=!0,ie||(y=[oe(n,"click",e[8]),oe(c,"click",e[9]),oe(f,"click",e[10]),oe(m,"click",e[11])],ie=!0)},p(d,[C]){if((!M||C&1)&&r!==(r=d[0]?"Show All":"Show B40")&&j(i,r),(!M||C&2&&a!==(a=d[1]!=0))&&(c.disabled=a),(!M||C&2&&k!==(k=d[1]!=0))&&(f.disabled=k),(!M||C&2)&&ee!==(ee=Object.keys(d[3])[d[1]]+"")&&j(G,ee),C&11){q=["#","Title","Const.","Score","Rating","FC/AJ"];let g;for(g=0;g<6;g+=1){const ae=ct(d,q,g);P[g]?P[g].p(ae,C):(P[g]=lt(ae),P[g].c(),P[g].m(_,null))}for(;g<6;g+=1)P[g].d(1)}if(C&4){U=d[2];let g;for(g=0;g<U.length;g+=1){const ae=ot(d,U,g);S[g]?S[g].p(ae,C):(S[g]=ut(ae),S[g].c(),S[g].m(K,null))}for(;g<S.length;g+=1)S[g].d(1);S.length=U.length}},i(d){M||(I(B.$$.fragment,d),M=!0)},o(d){H(B.$$.fragment,d),M=!1},d(d){d&&L(t),d&&L(z),d&&L(A),N(B),De(P,d),De(S,d),ie=!1,te(y)}}}function Tn(e,t,n){let r,i,{recordList:o}=t,c=Me(),u=0;const s={Rating:(m,v)=>v.rating-m.rating||v.const-m.const,Score:(m,v)=>v.score-m.score,"Const.":(m,v)=>v.const-m.const,Title:(m,v)=>m.title<v.title?-1:m.title>v.title?1:0},a=o.map(m=>m.rating),l=o.filter(m=>m.difficulty==="MAS").map(m=>m.score).reduce((m,v)=>m+v),f=()=>{n(0,c=!c),c&&n(1,u=0)},w=()=>it("b30"),T=()=>it("b40"),k=()=>{n(1,u=(u+1)%Object.keys(s).length),n(0,c=!1)},D=m=>{let v=Object.keys(s).indexOf(m);v>=0&&n(1,u=Object.keys(s).indexOf(m)),v>0&&n(0,c=!1)};return e.$$set=m=>{"recordList"in m&&n(6,o=m.recordList)},e.$$.update=()=>{e.$$.dirty&66&&n(7,r=o.sort(Object.values(s)[u])),e.$$.dirty&129&&n(2,i=c?r.slice(0,40):r)},[c,u,i,s,a,l,o,r,f,w,T,k,D]}class qn extends ve{constructor(t){super(),pe(this,t,Tn,En,fe,{recordList:6},kn)}}function Rn(e){de(e,"svelte-1xu3fxd","body.svelte-1xu3fxd.svelte-1xu3fxd{padding-top:1rem;background-color:#223;color:#eec;margin:0;min-height:100%;min-width:600px;width:fit-content}body.svelte-1xu3fxd a.svelte-1xu3fxd{color:#3cc;text-decoration:none}")}function Pn(e){let t,n;return t=new qn({props:{recordList:e[1]}}),{c(){ne(t.$$.fragment)},m(r,i){Z(t,r,i),n=!0},p(r,i){const o={};i&2&&(o.recordList=r[1]),t.$set(o)},i(r){n||(I(t.$$.fragment,r),n=!0)},o(r){H(t.$$.fragment,r),n=!1},d(r){N(t,r)}}}function Cn(e){let t;return{c(){t=p("div"),t.innerHTML="<p>Loading...</p>"},m(n,r){F(n,t,r)},p:Q,i:Q,o:Q,d(n){n&&L(t)}}}function Ln(e){let t,n,r,i,o,c;const u=[Cn,Pn],s=[];function a(l,f){return l[0]?1:0}return i=a(e),o=s[i]=u[i](e),{c(){t=p("body"),n=p("div"),n.innerHTML=`<h3>Chunithm International Score Viewer</h3> 
        <a href="https://github.com/Dogeon188/chuni_new_intl_viewer" target="_blank" rel="noopener noreferrer" class="svelte-1xu3fxd">Dogeon188/chuni_new_intl_viewer@GitHub</a>`,r=x(),o.c(),b(t,"class","svelte-1xu3fxd")},m(l,f){F(l,t,f),h(t,n),h(t,r),s[i].m(t,null),c=!0},p(l,[f]){let w=i;i=a(l),i===w?s[i].p(l,f):(wt(),H(s[w],1,1,()=>{s[w]=null}),_t(),o=s[i],o?o.p(l,f):(o=s[i]=u[i](l),o.c()),I(o,1),o.m(t,null))},i(l){c||(I(o),c=!0)},o(l){H(o),c=!1},d(l){l&&L(t),s[i].d()}}}function An(e,t,n){let r=!1,i=[];return(async()=>(n(1,i=await Et()),n(0,r=!0)))(),[r,i]}class Mn extends ve{constructor(t){super(),pe(this,t,An,Ln,fe,{},Rn)}}async function Fn(){if(window.chuniIntlViewer){alert("[chuni-intl-viewer] Please refresh the page before another new fetch.");return}if(window.chuniIntlViewer=!0,window.location.hostname!=="chunithm-net-eng.com"){alert("[chuni_intl_viewer] This tools could only be used under chunithm-net international."),window.location.href="https://chunithm-net-eng.com/";return}if(!Ae("_t")){alert("[chuni-intl-viewer] Token not found. Please login first."),window.location.href="https://chunithm-net-eng.com/";return}const e=document.body.attachShadow({mode:"open"});new Mn({target:e})}Fn()})();
