(function(){"use strict";function _t(t){const e=document.cookie.split(";").map(n=>decodeURIComponent(n.trim())).map(n=>n.split("=")).find(n=>n[0]===t);return e?e[1]:""}function St(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}function ne(t){return Number([...t].filter(e=>e!==",").join(""))}function D(){}function $t(t){return t()}function xt(){return Object.create(null)}function G(t){t.forEach($t)}function re(t){return typeof t=="function"}function Z(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let N;function Et(t,e){return N||(N=document.createElement("a")),N.href=e,t===N.href}function ie(t){return Object.keys(t).length===0}function h(t,e){t.appendChild(e)}function tt(t,e,n){const r=oe(t);if(!r.getElementById(e)){const i=g("style");i.id=e,i.textContent=n,ce(r,i)}}function oe(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function ce(t,e){h(t.head||t,e)}function P(t,e,n){t.insertBefore(e,n||null)}function R(t){t.parentNode.removeChild(t)}function le(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function g(t){return document.createElement(t)}function q(t){return document.createTextNode(t)}function _(){return q(" ")}function ft(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function se(t){return Array.from(t.childNodes)}function B(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let ht;function K(t){ht=t}const Q=[],Tt=[],et=[],jt=[],ue=Promise.resolve();let dt=!1;function ae(){dt||(dt=!0,ue.then(Rt))}function mt(t){et.push(t)}const gt=new Set;let nt=0;function Rt(){const t=ht;do{for(;nt<Q.length;){const e=Q[nt];nt++,K(e),fe(e.$$)}for(K(null),Q.length=0,nt=0;Tt.length;)Tt.pop()();for(let e=0;e<et.length;e+=1){const n=et[e];gt.has(n)||(gt.add(n),n())}et.length=0}while(Q.length);for(;jt.length;)jt.pop()();dt=!1,gt.clear(),K(t)}function fe(t){if(t.fragment!==null){t.update(),G(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(mt)}}const rt=new Set;let U;function he(){U={r:0,c:[],p:U}}function de(){U.r||G(U.c),U=U.p}function C(t,e){t&&t.i&&(rt.delete(t),t.i(e))}function A(t,e,n,r){if(t&&t.o){if(rt.has(t))return;rt.add(t),U.c.push(()=>{rt.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function z(t){t&&t.c()}function O(t,e,n,r){const{fragment:i,on_mount:o,on_destroy:c,after_update:f}=t.$$;i&&i.m(e,n),r||mt(()=>{const s=o.map($t).filter(re);c?c.push(...s):G(s),t.$$.on_mount=[]}),f.forEach(mt)}function H(t,e){const n=t.$$;n.fragment!==null&&(G(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function me(t,e){t.$$.dirty[0]===-1&&(Q.push(t),ae(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function it(t,e,n,r,i,o,c,f=[-1]){const s=ht;K(t);const u=t.$$={fragment:null,ctx:null,props:o,update:D,not_equal:i,bound:xt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:xt(),dirty:f,skip_bound:!1,root:e.target||s.$$.root};c&&c(u.root);let l=!1;if(u.ctx=n?n(t,e.props||{},(a,b,...w)=>{const E=w.length?w[0]:b;return u.ctx&&i(u.ctx[a],u.ctx[a]=E)&&(!u.skip_bound&&u.bound[a]&&u.bound[a](E),l&&me(t,a)),b}):[],u.update(),l=!0,G(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const a=se(e.target);u.fragment&&u.fragment.l(a),a.forEach(R)}else u.fragment&&u.fragment.c();e.intro&&C(t.$$.fragment),O(t,e.target,e.anchor,e.customElement),Rt()}K(s)}class ot{$destroy(){H(this,1),this.$destroy=D}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!ie(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ge(t,e){e*=100;const n=[[101e4,e+215],[1009e3,e+215],[1007500,e+200],[1005e3,e+150],[1e6,e+100],[975e3,e],[925e3,e-300],[9e5,e-500],[8e5,(e-500)/2],[5e5,0]];let r=1;n.some((f,s)=>(r=s,t>f[0]));const i=n[r-1],o=n[r],c=o[1]+(i[1]-o[1])/(i[0]-o[0])*(t-o[0]);return Math.floor(c+Number.EPSILON)/100}function kt(t){return t.slice(0,30).reduce((e,n)=>e+n)/30}function be(t){return(kt(t)*30+t[0]*10)/40}const M={ultima:"ULT",master:"MAS",expert:"EXP",advance:"ADV",basic:"BAS"};async function pe(t=M.master){const e=new FormData;e.append("genre","99"),e.append("token",_t("_t"));const n={[M.ultima]:"sendUltima",[M.master]:"sendMaster",[M.expert]:"sendExpert",[M.advance]:"sendAdvance",[M.basic]:"sendBasic"},i=await(await fetch(`https://chunithm-net-eng.com/mobile/record/musicGenre/${n[t]}`,{headers:{"Cache-Control":"no-cache"},method:"POST",body:e})).text(),o=[...$(i).find("form")];return o.shift(),o}async function ve(){const t=[];for(const e of Object.values(M))t.push(await pe(e));return t.flatMap((e,n)=>e.map(r=>{var f,s;const i=$(r),o=i.find(".play_musicdata_icon");let c=null;if(o.length){for(const u of["fullchain","fullchain2","alljustice","fullcombo"])if(o.find(`img[src*="${u}"]`).length){c=u;break}}return{title:(f=i.find(".music_title"))==null?void 0:f.text(),score:ne((s=i.find(".text_b"))==null?void 0:s.text()),difficulty:Object.values(M)[n],clear:c}}).filter(r=>r.title!==null&&r.score>0))}async function we(){const t=await(await fetch("https://raw.githubusercontent.com/Dogeon188/chuni_new_intl_viewer/main/songData.json")).json(),e=await ve();return e.map(n=>{const r=t[n.title];if(r===void 0){alert(`[chuni-intl-viewer] Found unknown song "${n.title} ${n.difficulty}".
The data should be updating soon, please run chuni-viewer again later to get proper song data.`),fetch(new Request("https://chuniupdate.dogeon188.repl.co/sendUpdate",{method:"POST"})),n.const=0,n.rating=0;return}n.const=r[n.difficulty],n.rating=ge(n.score,n.const)}),e.sort((n,r)=>r.rating-n.rating||r.const-n.const),e}function ye(t){tt(t,"svelte-1o207gt","dt.svelte-1o207gt{font-size:0.5em;color:#c9e}dd.svelte-1o207gt{margin-inline-start:1em}")}function _e(t){let e,n,r,i,o,c;return{c(){e=g("div"),n=g("dt"),r=q(t[0]),i=_(),o=g("dd"),c=q(t[1]),m(n,"class","svelte-1o207gt"),m(o,"class","svelte-1o207gt")},m(f,s){P(f,e,s),h(e,n),h(n,r),h(e,i),h(e,o),h(o,c)},p(f,[s]){s&1&&B(r,f[0]),s&2&&B(c,f[1])},i:D,o:D,d(f){f&&R(e)}}}function Se(t,e,n){let{title:r}=e,{content:i}=e;return t.$$set=o=>{"title"in o&&n(0,r=o.title),"content"in o&&n(1,i=o.content)},[r,i]}class ct extends ot{constructor(e){super(),it(this,e,Se,_e,Z,{title:0,content:1},ye)}}function $e(t){tt(t,"svelte-16q7hki","div.svelte-16q7hki{border:#536 3px solid;border-radius:0.5em;background-color:#324;width:fit-content;padding:0.5em;margin:0.5em;text-align:left}")}function xe(t){let e,n,r,i,o,c,f,s,u;return n=new ct({props:{title:"Generated at",content:new Date().toLocaleDateString()}}),i=new ct({props:{title:"Best 30 Avg.",content:t[0].toFixed(2)}}),c=new ct({props:{title:"Max Achievable",content:t[1].toFixed(2)}}),s=new ct({props:{title:"Total MAS Score",content:t[2].toString()}}),{c(){e=g("div"),z(n.$$.fragment),r=_(),z(i.$$.fragment),o=_(),z(c.$$.fragment),f=_(),z(s.$$.fragment),m(e,"class","svelte-16q7hki")},m(l,a){P(l,e,a),O(n,e,null),h(e,r),O(i,e,null),h(e,o),O(c,e,null),h(e,f),O(s,e,null),u=!0},p(l,[a]){const b={};a&1&&(b.content=l[0].toFixed(2)),i.$set(b);const w={};a&2&&(w.content=l[1].toFixed(2)),c.$set(w);const E={};a&4&&(E.content=l[2].toString()),s.$set(E)},i(l){u||(C(n.$$.fragment,l),C(i.$$.fragment,l),C(c.$$.fragment,l),C(s.$$.fragment,l),u=!0)},o(l){A(n.$$.fragment,l),A(i.$$.fragment,l),A(c.$$.fragment,l),A(s.$$.fragment,l),u=!1},d(l){l&&R(e),H(n),H(i),H(c),H(s)}}}function Ee(t,e,n){let{b30:r}=e,{maxAchievable:i}=e,{totalMasterScore:o}=e;return t.$$set=c=>{"b30"in c&&n(0,r=c.b30),"maxAchievable"in c&&n(1,i=c.maxAchievable),"totalMasterScore"in c&&n(2,o=c.totalMasterScore)},[r,i,o]}class Te extends ot{constructor(e){super(),it(this,e,Ee,xe,Z,{b30:0,maxAchievable:1,totalMasterScore:2},$e)}}var Pt=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(l){try{u(r.next(l))}catch(a){c(a)}}function s(l){try{u(r.throw(l))}catch(a){c(a)}}function u(l){l.done?o(l.value):i(l.value).then(f,s)}u((r=r.apply(t,e||[])).next())})};const qt="application/font-woff",Ct="image/jpeg",je={woff:qt,woff2:qt,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Ct,jpeg:Ct,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"};function Re(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function lt(t){const e=Re(t).toLowerCase();return je[e]||""}function ke(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),e&&(r.href=e),i.href=t,i.href}function bt(t){return t.search(/^(data:)/)!==-1}function st(t,e){return`data:${e};base64,${t}`}function Pe(t){return t.split(/,/)[1]}const qe=function(){let e=0;const n=()=>`0000${(Math.random()*Math.pow(36,4)<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${n()}${e}`)}();function F(t){const e=[];for(let n=0,r=t.length;n<r;n+=1)e.push(t[n]);return e}function ut(t,e){const n=window.getComputedStyle(t).getPropertyValue(e);return parseFloat(n.replace("px",""))}function Ce(t){const e=ut(t,"border-left-width"),n=ut(t,"border-right-width");return t.clientWidth+e+n}function Le(t){const e=ut(t,"border-top-width"),n=ut(t,"border-bottom-width");return t.clientHeight+e+n}function Ae(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}function Me(t){return t.toBlob?new Promise(e=>t.toBlob(e)):new Promise(e=>{const n=window.atob(t.toDataURL().split(",")[1]),r=n.length,i=new Uint8Array(r);for(let o=0;o<r;o+=1)i[o]=n.charCodeAt(o);e(new Blob([i],{type:"image/png"}))})}function pt(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>e(r),r.onerror=n,r.crossOrigin="anonymous",r.decoding="sync",r.src=t})}function Fe(t){return Pt(this,void 0,void 0,function*(){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)})}function Ie(t,e,n){return Pt(this,void 0,void 0,function*(){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),o=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${e}`),i.setAttribute("height",`${n}`),i.setAttribute("viewBox",`0 0 ${e} ${n}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),i.appendChild(o),o.appendChild(t),Fe(i)})}const vt={};function De(t){let e=t.replace(/\?.*/,"");return/ttf|otf|eot|woff2?/i.test(e)&&(e=e.replace(/.*\//,"")),e}function wt(t,e){const n=De(t);if(vt[n]!=null)return vt[n];e.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());const r=o=>{let c="";if(e.imagePlaceholder){const s=e.imagePlaceholder.split(/,/);s&&s[1]&&(c=s[1])}let f=`Failed to fetch resource: ${t}`;return o&&(f=typeof o=="string"?o:o.message),f&&console.error(f),{blob:c,contentType:""}},i=window.fetch(t).then(o=>o.blob().then(c=>({blob:c,contentType:o.headers.get("Content-Type")||""}))).then(({blob:o,contentType:c})=>new Promise((f,s)=>{const u=new FileReader;u.onloadend=()=>f({contentType:c,blob:u.result}),u.onerror=s,u.readAsDataURL(o)})).then(({blob:o,contentType:c})=>({contentType:c,blob:Pe(o)})).catch(r);return vt[n]=i,i}function Be(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function Ue(t){return F(t).map(e=>{const n=t.getPropertyValue(e),r=t.getPropertyPriority(e);return`${e}: ${n}${r?" !important":""};`}).join(" ")}function Oe(t,e,n){const r=`.${t}:${e}`,i=n.cssText?Be(n):Ue(n);return document.createTextNode(`${r}{${i}}`)}function Lt(t,e,n){const r=window.getComputedStyle(t,n),i=r.getPropertyValue("content");if(i===""||i==="none")return;const o=qe();try{e.className=`${e.className} ${o}`}catch{return}const c=document.createElement("style");c.appendChild(Oe(o,n,r)),e.appendChild(c)}function He(t,e){Lt(t,e,":before"),Lt(t,e,":after")}var X=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(l){try{u(r.next(l))}catch(a){c(a)}}function s(l){try{u(r.throw(l))}catch(a){c(a)}}function u(l){l.done?o(l.value):i(l.value).then(f,s)}u((r=r.apply(t,e||[])).next())})};function Ve(t){return X(this,void 0,void 0,function*(){const e=t.toDataURL();return e==="data:,"?Promise.resolve(t.cloneNode(!1)):pt(e)})}function We(t,e){return X(this,void 0,void 0,function*(){return Promise.resolve(t.poster).then(n=>wt(n,e)).then(n=>st(n.blob,lt(t.poster)||n.contentType)).then(n=>pt(n))})}function Ge(t,e){return X(this,void 0,void 0,function*(){return t instanceof HTMLCanvasElement?Ve(t):t instanceof HTMLVideoElement&&t.poster?We(t,e):Promise.resolve(t.cloneNode(!1))})}const ze=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT";function Xe(t,e,n){var r;return X(this,void 0,void 0,function*(){const i=ze(t)&&t.assignedNodes?F(t.assignedNodes()):F(((r=t.shadowRoot)!==null&&r!==void 0?r:t).childNodes);return i.length===0||t instanceof HTMLVideoElement?Promise.resolve(e):i.reduce((o,c)=>o.then(()=>At(c,n)).then(f=>{f&&e.appendChild(f)}),Promise.resolve()).then(()=>e)})}function Je(t,e){const n=window.getComputedStyle(t),r=e.style;!r||(n.cssText?r.cssText=n.cssText:F(n).forEach(i=>{r.setProperty(i,n.getPropertyValue(i),n.getPropertyPriority(i))}))}function Ke(t,e){t instanceof HTMLTextAreaElement&&(e.innerHTML=t.value),t instanceof HTMLInputElement&&e.setAttribute("value",t.value)}function Qe(t,e){return X(this,void 0,void 0,function*(){return e instanceof Element?Promise.resolve().then(()=>Je(t,e)).then(()=>He(t,e)).then(()=>Ke(t,e)).then(()=>e):Promise.resolve(e)})}function At(t,e,n){return X(this,void 0,void 0,function*(){return!n&&e.filter&&!e.filter(t)?Promise.resolve(null):Promise.resolve(t).then(r=>Ge(r,e)).then(r=>Xe(t,r,e)).then(r=>Qe(t,r))})}var Ye=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(l){try{u(r.next(l))}catch(a){c(a)}}function s(l){try{u(r.throw(l))}catch(a){c(a)}}function u(l){l.done?o(l.value):i(l.value).then(f,s)}u((r=r.apply(t,e||[])).next())})};const Mt=/url\((['"]?)([^'"]+?)\1\)/g,Ze=/url\([^)]+\)\s*format\((["'])([^"']+)\1\)/g,Ne=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function tn(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function en(t){const e=[];return t.replace(Mt,(n,r,i)=>(e.push(i),n)),e.filter(n=>!bt(n))}function nn(t,e,n,r,i){const o=n?ke(e,n):e;return Promise.resolve(o).then(c=>i?i(c):wt(c,r)).then(c=>typeof c=="string"?st(c,lt(e)):st(c.blob,lt(e)||c.contentType)).then(c=>t.replace(tn(e),`$1${c}$3`)).then(c=>c,()=>o)}function rn(t,{preferredFontFormat:e}){return e?t.replace(Ne,n=>{for(;;){const[r,,i]=Ze.exec(n)||[];if(!i)return"";if(i===e)return`src: ${r};`}}):t}function Ft(t){return t.search(Mt)!==-1}function It(t,e,n){return Ye(this,void 0,void 0,function*(){if(!Ft(t))return Promise.resolve(t);const r=rn(t,n);return Promise.resolve(r).then(en).then(i=>i.reduce((o,c)=>o.then(f=>nn(f,c,e,n)),Promise.resolve(r)))})}var at=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(l){try{u(r.next(l))}catch(a){c(a)}}function s(l){try{u(r.throw(l))}catch(a){c(a)}}function u(l){l.done?o(l.value):i(l.value).then(f,s)}u((r=r.apply(t,e||[])).next())})};function on(t,e){var n;return at(this,void 0,void 0,function*(){const r=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue("background");return r?Promise.resolve(r).then(i=>It(i,null,e)).then(i=>(t.style.setProperty("background",i,t.style.getPropertyPriority("background")),t)):Promise.resolve(t)})}function cn(t,e){return at(this,void 0,void 0,function*(){if(!(t instanceof HTMLImageElement&&!bt(t.src))&&!(t instanceof SVGImageElement&&!bt(t.href.baseVal)))return Promise.resolve(t);const n=t instanceof HTMLImageElement?t.src:t.href.baseVal;return Promise.resolve(n).then(r=>wt(r,e)).then(r=>st(r.blob,lt(n)||r.contentType)).then(r=>new Promise((i,o)=>{t.onload=i,t.onerror=o,t instanceof HTMLImageElement?(t.srcset="",t.src=r):t.href.baseVal=r})).then(()=>t,()=>t)})}function ln(t,e){return at(this,void 0,void 0,function*(){const r=F(t.childNodes).map(i=>Dt(i,e));return Promise.all(r).then(()=>t)})}function Dt(t,e){return at(this,void 0,void 0,function*(){return t instanceof Element?Promise.resolve(t).then(n=>on(n,e)).then(n=>cn(n,e)).then(n=>ln(n,e)):Promise.resolve(t)})}function sn(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(i=>{n[i]=r[i]}),t}var Y=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(l){try{u(r.next(l))}catch(a){c(a)}}function s(l){try{u(r.throw(l))}catch(a){c(a)}}function u(l){l.done?o(l.value):i(l.value).then(f,s)}u((r=r.apply(t,e||[])).next())})};const Bt={};function Ut(t){const e=Bt[t];if(e!=null)return e;const n=window.fetch(t).then(r=>({url:t,cssText:r.text()}));return Bt[t]=n,n}function Ot(t){return Y(this,void 0,void 0,function*(){return t.cssText.then(e=>{let n=e;const r=/url\(["']?([^"')]+)["']?\)/g,o=(n.match(/url\([^)]+\)/g)||[]).map(c=>{let f=c.replace(r,"$1");return f.startsWith("https://")||(f=new URL(f,t.url).href),window.fetch(f).then(s=>s.blob()).then(s=>new Promise((u,l)=>{const a=new FileReader;a.onloadend=()=>{n=n.replace(c,`url(${a.result})`),u([c,a.result])},a.onerror=l,a.readAsDataURL(s)}))});return Promise.all(o).then(()=>n)})})}function Ht(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const s=i.exec(r);if(s===null)break;e.push(s[0])}r=r.replace(i,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,c="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",f=new RegExp(c,"gi");for(;;){let s=o.exec(r);if(s===null){if(s=f.exec(r),s===null)break;o.lastIndex=f.lastIndex}else f.lastIndex=o.lastIndex;e.push(s[0])}return e}function un(t){return Y(this,void 0,void 0,function*(){const e=[],n=[];return t.forEach(r=>{if("cssRules"in r)try{F(r.cssRules).forEach((i,o)=>{if(i.type===CSSRule.IMPORT_RULE){let c=o+1;const f=i.href,s=Ut(f).then(u=>u?Ot(u):"").then(u=>Ht(u).forEach(l=>{try{r.insertRule(l,l.startsWith("@import")?c+=1:r.cssRules.length)}catch(a){console.error("Error inserting rule from remote css",{rule:l,error:a})}})).catch(u=>{console.error("Error loading remote css",u.toString())});n.push(s)}})}catch(i){const o=t.find(c=>c.href==null)||document.styleSheets[0];r.href!=null&&n.push(Ut(r.href).then(c=>c?Ot(c):"").then(c=>Ht(c).forEach(f=>{o.insertRule(f,r.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c.toString())})),console.error("Error inlining remote css file",i.toString())}}),Promise.all(n).then(()=>(t.forEach(r=>{if("cssRules"in r)try{F(r.cssRules).forEach(i=>{e.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${r.href}`,i.toString())}}),e))})}function an(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>Ft(e.style.getPropertyValue("src")))}function fn(t){return Y(this,void 0,void 0,function*(){return new Promise((e,n)=>{t.ownerDocument==null&&n(new Error("Provided element is not within a Document")),e(F(t.ownerDocument.styleSheets))}).then(e=>un(e)).then(an)})}function hn(t,e){return Y(this,void 0,void 0,function*(){return fn(t).then(n=>Promise.all(n.map(r=>{const i=r.parentStyleSheet?r.parentStyleSheet.href:null;return It(r.cssText,i,e)}))).then(n=>n.join(`
`))})}function dn(t,e){return Y(this,void 0,void 0,function*(){return(e.fontEmbedCSS!=null?Promise.resolve(e.fontEmbedCSS):hn(t,e)).then(n=>{const r=document.createElement("style"),i=document.createTextNode(n);return r.appendChild(i),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),t})})}var yt=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function f(l){try{u(r.next(l))}catch(a){c(a)}}function s(l){try{u(r.throw(l))}catch(a){c(a)}}function u(l){l.done?o(l.value):i(l.value).then(f,s)}u((r=r.apply(t,e||[])).next())})};function Vt(t,e={}){const n=e.width||Ce(t),r=e.height||Le(t);return{width:n,height:r}}function mn(t,e={}){return yt(this,void 0,void 0,function*(){const{width:n,height:r}=Vt(t,e);return Promise.resolve(t).then(i=>At(i,e,!0)).then(i=>dn(i,e)).then(i=>Dt(i,e)).then(i=>sn(i,e)).then(i=>Ie(i,n,r))})}const S=16384;function gn(t){(t.width>S||t.height>S)&&(t.width>S&&t.height>S?t.width>t.height?(t.height*=S/t.width,t.width=S):(t.width*=S/t.height,t.height=S):t.width>S?(t.height*=S/t.width,t.width=S):(t.width*=S/t.height,t.height=S))}function bn(t,e={}){return yt(this,void 0,void 0,function*(){return mn(t,e).then(pt).then(n=>{const r=document.createElement("canvas"),i=r.getContext("2d"),o=e.pixelRatio||Ae(),{width:c,height:f}=Vt(t,e),s=e.canvasWidth||c,u=e.canvasHeight||f;return r.width=s*o,r.height=u*o,e.skipAutoScale||gn(r),r.style.width=`${s}`,r.style.height=`${u}`,e.backgroundColor&&(i.fillStyle=e.backgroundColor,i.fillRect(0,0,r.width,r.height)),i.drawImage(n,0,0,r.width,r.height),r})})}function pn(t,e={}){return yt(this,void 0,void 0,function*(){return bn(t,e).then(Me)})}async function vn(t){var r,i;const e=(r=document.body.shadowRoot)==null?void 0:r.querySelector("main");let n=e==null?void 0:e.cloneNode(!0);(i=e==null?void 0:e.parentElement)==null||i.appendChild(n),n.querySelectorAll("tr").forEach((o,c)=>{c>(t=="b30"?30:40)&&o.remove()}),pn(n,{backgroundColor:"#223"}).then(async o=>{if(n.remove(),o==null)return alert("[chuni-intl-viewer] Something went wrong when converting your scores to PNG. Please ask the author to fix it.");if(St()){const c=new File([o],`result_${t}.png`,{type:o.type});navigator!=null&&navigator.canShare({files:[c]})&&navigator.share({files:[c],text:"#CHUNITHM"}).catch(console.log)}else $("<a>").attr({download:`result_${t}.png`,href:window.URL.createObjectURL(o)})[0].click()})}async function Wt(t,e){$(t.currentTarget).fadeTo(100,.5),await vn(e),$(t.currentTarget).fadeTo(100,1)}function wn(t){tt(t,"svelte-yhbqtj","button.svelte-yhbqtj.svelte-yhbqtj{margin:0.5em;padding:0.3em;font-family:inherit;font-weight:bold;background-color:#324;border:#536 3px solid;color:#eec;border-radius:0.3em;cursor:pointer}button.filter.svelte-yhbqtj.svelte-yhbqtj{border-color:#48c;background-color:#159}button.dl.svelte-yhbqtj i.svelte-yhbqtj{background-image:url(https://raw.githubusercontent.com/Dogeon188/chuni_new_intl_viewer/main/assets/dl.png);display:inline-block;width:1em;height:1em;background-position:0px 0px;background-size:cover}table.svelte-yhbqtj.svelte-yhbqtj{border-spacing:0;padding-bottom:1em;width:100%}td.svelte-yhbqtj.svelte-yhbqtj,th.svelte-yhbqtj.svelte-yhbqtj{padding:0.5em}tbody.svelte-yhbqtj tr:nth-child(-n+30) td.svelte-yhbqtj:first-child{color:#fc4}tbody.svelte-yhbqtj tr:nth-child(-n+40) td.svelte-yhbqtj:first-child{font-weight:bold}tbody.svelte-yhbqtj tr.svelte-yhbqtj:nth-child(odd){background-color:#324}tbody.svelte-yhbqtj tr td.svelte-yhbqtj:nth-child(2){overflow:hidden;text-overflow:ellipsis;font-weight:bold}tbody.svelte-yhbqtj tr td:nth-child(2).diff-ult.svelte-yhbqtj{color:#3cf}tbody.svelte-yhbqtj tr td:nth-child(2).diff-mas.svelte-yhbqtj{color:#e9f}tbody.svelte-yhbqtj tr td:nth-child(2).diff-exp.svelte-yhbqtj{color:#e46}tbody.svelte-yhbqtj tr td:nth-child(2).diff-adv.svelte-yhbqtj{color:#e73}tbody.svelte-yhbqtj tr td:nth-child(2).diff-bas.svelte-yhbqtj{color:#1c3}")}function Gt(t,e,n){const r=t.slice();return r[8]=e[n],r[10]=n,r}function zt(t){let e,n,r;return{c(){e=g("img"),Et(e.src,n="https://chunithm-net-eng.com/mobile/images/icon_"+t[8].clear+".png")||m(e,"src",n),m(e,"alt",r=t[8].clear)},m(i,o){P(i,e,o)},p(i,o){o&2&&!Et(e.src,n="https://chunithm-net-eng.com/mobile/images/icon_"+i[8].clear+".png")&&m(e,"src",n),o&2&&r!==(r=i[8].clear)&&m(e,"alt",r)},d(i){i&&R(e)}}}function Xt(t){var Jt,Kt,Qt,Yt;let e,n,r=t[10]+1+"",i,o,c,f=t[8].title+"",s,u,l,a,b=((Kt=(Jt=t[8].const)==null?void 0:Jt.toFixed(1))!=null?Kt:"??.?")+"",w,E,V,k=t[8].score+"",L,J,W,j=((Yt=(Qt=t[8].rating)==null?void 0:Qt.toFixed(2))!=null?Yt:"??.??")+"",v,d,x,p,y=t[8].clear!==null&&zt(t);return{c(){e=g("tr"),n=g("td"),i=q(r),o=_(),c=g("td"),s=q(f),l=_(),a=g("td"),w=q(b),E=_(),V=g("td"),L=q(k),J=_(),W=g("td"),v=q(j),d=_(),x=g("td"),y&&y.c(),p=_(),m(n,"class","svelte-yhbqtj"),m(c,"class",u="diff-"+t[8].difficulty.toLowerCase()+" svelte-yhbqtj"),m(a,"class","svelte-yhbqtj"),m(V,"class","svelte-yhbqtj"),m(W,"class","svelte-yhbqtj"),m(x,"class","svelte-yhbqtj"),m(e,"class","svelte-yhbqtj")},m(T,I){P(T,e,I),h(e,n),h(n,i),h(e,o),h(e,c),h(c,s),h(e,l),h(e,a),h(a,w),h(e,E),h(e,V),h(V,L),h(e,J),h(e,W),h(W,v),h(e,d),h(e,x),y&&y.m(x,null),h(e,p)},p(T,I){var Zt,Nt,te,ee;I&2&&f!==(f=T[8].title+"")&&B(s,f),I&2&&u!==(u="diff-"+T[8].difficulty.toLowerCase()+" svelte-yhbqtj")&&m(c,"class",u),I&2&&b!==(b=((Nt=(Zt=T[8].const)==null?void 0:Zt.toFixed(1))!=null?Nt:"??.?")+"")&&B(w,b),I&2&&k!==(k=T[8].score+"")&&B(L,k),I&2&&j!==(j=((ee=(te=T[8].rating)==null?void 0:te.toFixed(2))!=null?ee:"??.??")+"")&&B(v,j),T[8].clear!==null?y?y.p(T,I):(y=zt(T),y.c(),y.m(x,null)):y&&(y.d(1),y=null)},d(T){T&&R(e),y&&y.d()}}}function yn(t){let e,n,r=t[0]?"Show All":"Show B40",i,o,c,f,s,u,l,a,b,w,E,V,k,L,J,W;a=new Te({props:{b30:kt(t[2]),maxAchievable:be(t[2]),totalMasterScore:t[3]}});let j=t[1],v=[];for(let d=0;d<j.length;d+=1)v[d]=Xt(Gt(t,j,d));return{c(){e=g("div"),n=g("button"),i=q(r),o=_(),c=g("button"),c.innerHTML='<i class="svelte-yhbqtj"></i>Best 30',f=_(),s=g("button"),s.innerHTML='<i class="svelte-yhbqtj"></i>Best 40',u=_(),l=g("main"),z(a.$$.fragment),b=_(),w=g("table"),E=g("thead"),E.innerHTML=`<tr><th class="svelte-yhbqtj">#</th> 
            <th class="svelte-yhbqtj">Song Name</th> 
            <th class="svelte-yhbqtj">Constant</th> 
            <th class="svelte-yhbqtj">Score</th> 
            <th class="svelte-yhbqtj">Rating</th> 
            <th class="svelte-yhbqtj">FC/AJ</th></tr>`,V=_(),k=g("tbody");for(let d=0;d<v.length;d+=1)v[d].c();m(n,"class","filter svelte-yhbqtj"),m(c,"class","dl svelte-yhbqtj"),m(s,"class","dl svelte-yhbqtj"),m(e,"class","buttons"),m(k,"class","svelte-yhbqtj"),m(w,"id","chuni-result-table"),m(w,"class","svelte-yhbqtj"),m(l,"id","chuni-viewer-main")},m(d,x){P(d,e,x),h(e,n),h(n,i),h(e,o),h(e,c),h(e,f),h(e,s),P(d,u,x),P(d,l,x),O(a,l,null),h(l,b),h(l,w),h(w,E),h(w,V),h(w,k);for(let p=0;p<v.length;p+=1)v[p].m(k,null);L=!0,J||(W=[ft(n,"click",t[5]),ft(c,"click",t[6]),ft(s,"click",t[7])],J=!0)},p(d,[x]){if((!L||x&1)&&r!==(r=d[0]?"Show All":"Show B40")&&B(i,r),x&2){j=d[1];let p;for(p=0;p<j.length;p+=1){const y=Gt(d,j,p);v[p]?v[p].p(y,x):(v[p]=Xt(y),v[p].c(),v[p].m(k,null))}for(;p<v.length;p+=1)v[p].d(1);v.length=j.length}},i(d){L||(C(a.$$.fragment,d),L=!0)},o(d){A(a.$$.fragment,d),L=!1},d(d){d&&R(e),d&&R(u),d&&R(l),H(a),le(v,d),J=!1,G(W)}}}function _n(t,e,n){let r,{recordList:i}=e,o=St();const c=i.map(a=>a.rating),f=i.filter(a=>a.difficulty==="MAS").map(a=>a.score).reduce((a,b)=>a+b),s=()=>{n(0,o=!o)},u=a=>Wt(a,"b30"),l=a=>Wt(a,"b40");return t.$$set=a=>{"recordList"in a&&n(4,i=a.recordList)},t.$$.update=()=>{t.$$.dirty&17&&n(1,r=o?i.slice(0,40):i)},[o,r,c,f,i,s,u,l]}class Sn extends ot{constructor(e){super(),it(this,e,_n,yn,Z,{recordList:4},wn)}}function $n(t){tt(t,"svelte-824f03","body.svelte-824f03.svelte-824f03{padding:0.1em;background-color:#223;color:#eec;margin:0;min-height:100%;min-width:600px;width:fit-content}body.svelte-824f03 a.svelte-824f03{color:#3cc;text-decoration:none}")}function xn(t){let e,n;return e=new Sn({props:{recordList:t[1]}}),{c(){z(e.$$.fragment)},m(r,i){O(e,r,i),n=!0},p(r,i){const o={};i&2&&(o.recordList=r[1]),e.$set(o)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){H(e,r)}}}function En(t){let e;return{c(){e=g("div"),e.textContent="Loading...",m(e,"id","chuni-msg")},m(n,r){P(n,e,r)},p:D,i:D,o:D,d(n){n&&R(e)}}}function Tn(t){let e,n,r,i,o,c;const f=[En,xn],s=[];function u(l,a){return l[0]?1:0}return i=u(t),o=s[i]=f[i](t),{c(){e=g("body"),n=g("div"),n.innerHTML=`<h3>Chunithm International Score Viewer</h3> 
        <a href="https://github.com/Dogeon188/chuni_new_intl_viewer" target="_blank" rel="noopener noreferrer" class="svelte-824f03">Dogeon188/chuni_new_intl_viewer@GitHub</a>`,r=_(),o.c(),m(e,"class","svelte-824f03")},m(l,a){P(l,e,a),h(e,n),h(e,r),s[i].m(e,null),c=!0},p(l,[a]){let b=i;i=u(l),i===b?s[i].p(l,a):(he(),A(s[b],1,1,()=>{s[b]=null}),de(),o=s[i],o?o.p(l,a):(o=s[i]=f[i](l),o.c()),C(o,1),o.m(e,null))},i(l){c||(C(o),c=!0)},o(l){A(o),c=!1},d(l){l&&R(e),s[i].d()}}}function jn(t,e,n){let r=!1,i=[];return(async()=>(n(1,i=await we()),n(0,r=!0)))(),[r,i]}class Rn extends ot{constructor(e){super(),it(this,e,jn,Tn,Z,{},$n)}}async function kn(){if(window.chuniIntlViewer){alert("[chuni-intl-viewer] Please refresh the page before another new fetch.");return}if(window.chuniIntlViewer=!0,window.location.hostname!=="chunithm-net-eng.com"){alert("[chuni_intl_viewer] This tools could only be used under chunithm-net international."),window.location.href="https://chunithm-net-eng.com/";return}if(!_t("_t")){alert("[chuni-intl-viewer] Token not found. Please login first."),window.location.href="https://chunithm-net-eng.com/";return}const t=document.body.attachShadow({mode:"open"});new Rn({target:t})}kn()})();
